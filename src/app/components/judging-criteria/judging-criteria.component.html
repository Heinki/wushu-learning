<div class="practice-container card-container">

  @if (error) {
    <div class="error-container">
      <app-card [title]="'judgingCriteria.error' | translate">
        <p>{{ 'judgingCriteria.errorMessage' | translate }}</p>
      </app-card>
    </div>
  }

  @if (!loading && !error) {
    <div class="techniques-container">
      <div class="controls-container">
        <button class="btn control-btn" (click)="openAllCategories()">{{ 'judgingCriteria.openAll' | translate }}</button>
        <button class="btn control-btn" (click)="closeAllCategories()">{{ 'judgingCriteria.closeAll' | translate }}</button>
      </div>
      
      @if (techniques.length === 0) {
        <app-card [title]="'judgingCriteria.noTechniques' | translate">
          <p>{{ 'judgingCriteria.noTechniquesMessage' | translate }}</p>
        </app-card>
      }

      @for (category of objectKeys(groupedTechniques); track category) {
        <div class="category-section">
          <div class="category-header" (click)="toggleCategory(category)">
            <h2 class="category-title">{{ category }} <span class="toggle-icon">{{ isCategoryOpen(category) ? 'âˆ’' : '+' }}</span></h2>
          </div>
          <div class="techniques-grid card-grid" [class.expanded]="isCategoryOpen(category)" [class.collapsed]="!isCategoryOpen(category)">
            @for (technique of groupedTechniques[category]; track technique.code) {
              <app-card
                [title]="technique.technique_name"
                [subtitle]="('judgingCriteria.code' | translate) + ' ' + technique.code"
                [hasFooter]="true"
              >
                <div class="technique-info">
                  <p class="deduction-points">{{ technique.deduction_content }} {{ 'judgingCriteria.deductionPoints' | translate }}</p>
                </div>
                <div card-footer>
                  <button class="btn" (click)="navigateToTechnique(technique.code)">{{ 'judgingCriteria.viewDetails' | translate }}</button>
                </div>
              </app-card>
            }
          </div>
        </div>
      }
    </div>
  }
</div>
