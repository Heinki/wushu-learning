<div class="mistakes-container card-container">
  <div class="header">
    <h2>Common Mistakes</h2>
    <button *ngIf="mistakes.length > 0" class="clear-btn" (click)="clearAllMistakes()">Clear All</button>
  </div>

  <div *ngIf="loading" class="loading-indicator">
    Loading mistakes...
  </div>

  <div *ngIf="!loading && mistakes.length === 0" class="no-mistakes">
    <app-card title="No Mistakes Tracked">
      <p>You haven't made any mistakes during practice yet, or they have been cleared.</p>
      <p class="storage-notice"><i>Note: Mistake data is stored locally in your browser. If you clear your browser data or cookies, this information will also be deleted.</i></p>
    </app-card>
  </div>

  <div *ngIf="!loading && mistakes.length > 0" class="mistakes-list">
    <ng-container *ngFor="let category of objectKeys(groupedMistakes)">
      <div class="category-section">
        <h3 class="category-title">{{ category }}</h3>
        <div class="mistakes-grid card-grid">
          <app-card
            *ngFor="let mistake of groupedMistakes[category]"
            [title]="mistake.technique_name"
            [subtitle]="'Code: ' + mistake.technique_code + ' | Mistakes: ' + mistake.count"
            [hasFooter]="true"
          >
            <div class="mistake-info">
              <p class="question"><strong>Question:</strong> {{ mistake.question }}</p>
              <p class="answer"><strong>Answer:</strong> {{ mistake.answer }}</p>
            </div>
            <div card-footer class="card-footer-buttons">
              <button class="btn primary-btn" (click)="navigateToTechnique(mistake.technique_code)">View Details</button>
            </div>
          </app-card>
        </div>
      </div>
    </ng-container>
  </div>
</div>
