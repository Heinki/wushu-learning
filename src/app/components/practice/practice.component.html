<div class="practice-container">
  @if (showOverview) {
    <h2>{{ 'practice.title' | translate }}</h2>
    <div class="category-buttons">
      @for (category of categories; track category) {
        <button
          (click)="selectCategory(category)"
          class="category-button"
        >
          {{ category }}
        </button>
      }
    </div>
  } @else {
    @if (isLoading) {
      <div class="loading-indicator">
        {{ 'practice.loading' | translate }}
      </div>
    }
    @if (!isLoading && currentQuestion && !showSummary) {
      <div class="question-container" [ngClass]="{ 'box-correct': isCorrect === true, 'box-incorrect': isCorrect === false }">
        <div class="progress-indicator">
          {{ 'practice.progress' | translate }} {{ currentIndex }} {{ 'practice.of' | translate }} {{ totalQuestions }}
        </div>

        <div class="question">
          {{ currentQuestion.question }}
        </div>

        <div class="answer-input" [class.correct]="isCorrect === true" [class.incorrect]="isCorrect === false">
          <input
            type="text"
            [(ngModel)]="userAnswer"
            [placeholder]="'practice.yourAnswer' | translate"
            (keyup.enter)="checkAnswer()"
            [disabled]="checkDisabled"
          />
          @if (!checkDisabled) {
            <button (click)="checkAnswer()">{{ 'practice.check' | translate }}</button>
          }
        </div>
        @if (showCorrectAnswer && !isCorrect) {
          <div class="correct-answer">
            {{ 'practice.correctAnswer' | translate }} {{ currentQuestion.answer }}
          </div>
        }


      @if (isCorrect !== null) {
        <div class="feedback">
          @if (isCorrect) {
            <span>{{ 'practice.correct' | translate }}</span>
          } @else {
            <span>{{ 'practice.incorrect' | translate }}</span>
          }
          <button (click)="nextQuestion()">{{ 'practice.nextQuestion' | translate }}</button>
        </div>
      }
    </div>
    } @if (!isLoading && !currentQuestion && totalQuestions === 0) {
      <div class="no-questions-message">
        <span>{{ 'practice.noQuestions' | translate }}</span>
        <button class="back-to-categories-btn" (click)="showOverview = true">{{ 'practice.backToCategories' | translate }}</button>
      </div>
    }
    @if (showSummary) {
      <div class="summary-container">
        <h3>{{ 'practice.summary.title' | translate }}</h3>
        <table class="summary-table">
          <thead>
            <tr>
              <th>#</th>
              <th>{{ 'practice.summary.question' | translate }}</th>
              <th>{{ 'practice.summary.yourAnswer' | translate }}</th>
              <th>{{ 'practice.summary.result' | translate }}</th>
            </tr>
          </thead>
          <tbody>
            @for (item of answerHistory; track item; let i = $index) {
              <tr [ngClass]="{ 'row-correct': item.correct, 'row-incorrect': !item.correct }">
                <td>{{ i + 1 }}</td>
                <td>{{ item.question }}</td>
                <td>{{ item.userAnswer }}</td>
                <td>
                  @if (item.correct) {
                    <span>{{ 'practice.summary.correct' | translate }}</span>
                  } @else {
                    <span>{{ 'practice.summary.incorrect' | translate }}</span>
                  }
                </td>
              </tr>
            }
          </tbody>
        </table>
        <button class="back-to-categories-btn" (click)="resetPractice()">{{ 'practice.backToCategories' | translate }}</button>
      </div>
    }
  }
</div>
